---
import { countWords } from "alfaaz";
import FormattedDate from "../components/FormattedDate.astro";
import BaseHead from "../components/layout/BaseHead.astro";
import ExpandedContact from "../components/layout/ExpandedContact.astro";
import Header from "../components/layout/Header.astro";
import Scribbles from "../components/layout/Scribbles.astro";

import type { MarkdownLayoutProps } from "astro";
import { siteTitle } from "../consts";

type Props = MarkdownLayoutProps<{
  title: string;
  description: string;
  pubDate: string;
  lastEdit: string;
  heroImage: string;
  length: number;
}>;

const { title, description, pubDate, lastEdit, heroImage } =
  Astro.props.frontmatter;

const length = countWords(Astro.props.rawContent());
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead title={siteTitle(title)} description={description} />
  </head>
  <body class="mx-gutter overflow-x-hidden">
    <div class="noise"></div>
    <Scribbles />
    <Header title={title} />
    <main class="grid grid-cols-[repeat(3,auto)] gap-24 justify-start">
      <aside class="relative">
        <img
          src="/dotssmall.svg"
          alt=""
          class="absolute -z-10 left-0 top-0 -bottom-2 -translate-x-12"
        />
        <h1 class="w-[18ch] mb-[4.5rem]">{title}</h1>

        <div class="flex flex-col">
          <FormattedDate dateString={pubDate} />
          <span>
            {length} words
          </span>
          <span>
            {Math.ceil(length / 200)} min read
          </span>
        </div>
      </aside>
      <section class="w-[55ch] text-b-gray content-md mb-20 mt-2">
        <slot />
      </section>
      <ExpandedContact />
    </main>
  </body>
</html>
